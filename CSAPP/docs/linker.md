# 链接器

链接是将各种代码和数据片段收集并组合成为单个可执行的文件的过程，这个文件可以被加载（复制）到内存并执行。链接可以执行于编译时，也就是在源代码被翻译成机器代码阶段；也可以执行于加载时，即程序被加载器（loader）加载到内存并执行；甚至是运行时，也就是应用程序来执行。

**编译驱动程序的最终目的就是将 ASCII 源代码翻译成可执行的目标文件。**

运行过程就是 

1. 源代码 `main.c`
2. 将源代码转成中间语言（C 预处理器将 `main.c` 翻译成 `main.i`）
3. 将中间语言转为 ASCII 汇编语言文件（C 编译器将 `main.i` 转成 `main.s`）
4. 将汇编语言文件转成可重定向的目标文件（汇编器将 `main.s` 转成 `main.o`）

链接器的职责就是将上述步骤生成的可重定向的目标文件(`main.o`)链接在一起生成一个可执行的目标文件。

而加载器就是将可执行目标文件加载（复制）到内存中执行。

## 静态链接器

以一组可重定位的目标文件和命令参数作为输入，生成一个完全可链接的可以加载和运行的可执行文件作为输出。

链接器的一个基本事实就是：**目标文件纯粹就是字节的集合，其中包含程序代码和数据程序以及用来引导链接器和加载器的数据结构**。将这些块连接起来就能确定运行的位置。

## 目标文件

目标文件三种形式

1. 可重定向目标文件：**包含二进制代码和数据**，可以在编译时重定向目标文件，将结合起来生成一个可执行文件
2. 可执行目标文件：包含**二进制代码和数据**，可以加载（复制）到内存中并执行
3. 共享目标文件：是一种特殊的可执行的目标文件，可以加载或运行时动态的加载（复制）到内存中执行。

编译器和汇编器生成可重定向的目标文件

链接器生成可执行的目标文件

## 符号表

每个可重定向目标文件中都有一个符号表：包括符号定义 m 以及符号引用的信息

符号表有三种表现形式：

1. 模块 m 定义的以及被其它模块引用的**全局符号**，全局链接器符号对应于非静态的 C 函数和全局变量。
2. 被其它模块定义以及被模块 m 引用的全局符号，也叫”外部符号“。对应于其它模块定义的非静态的 C 函数和全局变量。
3. 模块 m 定义的以及被自己引用的局部符号，在 m 模块中任意可见，但是无法被其它模块引用。

符号表的基本数据结构：

