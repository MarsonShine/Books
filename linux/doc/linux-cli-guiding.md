# Linux 常用命令

查看IP连接信息

nestat -an

查看 TCP 端口连接数

netstat -nat|grep -i "端口数"|wc -l

```shell
# netstat | less // 查询本地所有的 socket
# netstat |wc -l // wc -l 是查询有多少个 socket
# netstat -t // 查看有哪些TCP连接
# netstat -t tcp // 查看有哪些tcp网络情况
# netstat -ntlp |grep 22	// 查看具体哪个端口的占用情况 -n：将特殊的端口号用数字显示，-t：tcp，-l：只显示连接中的连接，-p：显示程序名称
# netstat -antp //所有连接、数字显示主机、端口、TCP连接、监听的程序

# netstat -anup //所有连接、数字显示主机、端口、UDP连接、监听的程序

# netstat -s //统计所有（开机至今的）连接数据，包括tcp、udp等

# netstat -st //统计所有tcp连接数据

# netstat -su //统计所有udp连接数据

# netstat -su //粗略统计连接数据

# netstat -nlp|grep 9000 查指定端口号的信息

# sudo lsof -i tcp:6801 | wc -l 
```

```shell
# 删除文件
rm -f filepath
# 删除文件下所有的文件
rm -rf folderPath	// -r 向下递归，不管有多少级目录，全部删除 -f 强制删除

ps -ef|grep redis // 查看 redis 服务器是否都已经正常启动
```

ping ip 段的结果字段解析

- icmp_seq：一个网站需要使用 ICMP 协议，因此有这个字段
- time：往返一次的时间
- ttl：time to live，封包的生存时间，就是说一个封包开始倒计时，如果超过了返回显示的数字，就会丢包。

## vim 操作

```shell
vim filePath  // vim appsetting.json 进入命令模式
// 从其它地方复制内容到指定的文件
// 先按方向键找到要粘贴插入的位置
// 输入 shift + insert

// 删除多行
: 1,100d	// 删除从第1行到100行的内容

// 推出并保存
:wq

// 撤销最近一次的动作
:undo 或 :u
```

查看 linux 后台执行了哪些程序：`ps -aux`

关闭linux正确操作：1. sync(同步数据) 2.shutdown(关机) 3.reboot,halt,poweroff(重新开机，关机)

## ls 指令

```shell
ls # 查看当前目录下的所有文件
ls -al # 查看当前目录下的所有文件的详细信息（权限，时间，所属者等等）
ls -l --full-time	# 显示完整时间
```



## 权限

关于文件权限描述，总共有10个占位符：drwxr-xr-x

- 第一位代表的是“目录、文件或链接文件”：
  - [d]：目录
  - [-]：文件
  - [l]：链接文件（link file）
  - [b]：设备文件里面的可供储存的周边设备（可随机存取设备）
  - [c]：设备文件里面的序列埠设备，例如键盘、鼠标（一次性读取设
    备）
- 剩下的位是以三个为一组，都是”rwx“三个参数中组合。r：可读，w：可写，x：执行；要注意，这三个字符位置不会改变，如果没有权限，就会以”-“代替
  - 第一组为”文件拥有者可具备的权限“，以上面的例子举例：该文件拥有者可以读，写，执行
  - 第二组为”加入此群组之帐号的权限“
  - 第三组为“非本人且没有加入本群组之其他帐号的权限”

举个完整的例子：\[-][rwx]\[r-x][r--] > 1 234 567 890

1：表示文件目录或链接文件，这里是（-）

234：拥有者的权限，可读可写可执行

567：同群组的使用者权限，对应到 r-x 可读可执行不可写

890：其他使用者权限，可读

### 修改文件权限命令

主要有三个：

- chgrp：改变文件所属群组（change group），**被改变的群组名必须要在 /etc/group 中**
- chown：改变文件拥有者，**在 /etc/passwd 这个文件中有纪录的使用者名称才能改变**
- chmod：改变文件的权限，SUID, SGID, SBIT等等的特性

```shell
# 如果想把某个文件夹并且连同这个文件下的所有次目录或文件的拥有者改变，可以加可选参数 -R
chown [-R] 账号名称 文件或目录
chown [-R] 账号名称:群组名称 文件或目录
```

Linux 使用数字来表示各个权限，各权限对照表如下：

r:4 > w:2 > x:1

每组身份各自的三个权限都是累加的，例如当权限为: \[-rwxrwx---] 分数则是：onwer = rwx = 4 + 2 + 1 = 7 > group = rwx = 4+2+1 = 7 > others = --- = 0 + 0 + 0 = 0；那么该文件的权限数字就是 770，那这样命令就成了 `chmod [-R] 770 文件或目录`

## 文件操作类的指令

Linux 中以小数点 `.` 开头的都是隐藏文件

```shell
cp source destination # 拷贝文件从 source 到 destination
```

### 目录处理指令

```shell
cd # 变换目录 change directory
###################################################
pwd # 显示目前的目录
pwd -P # 显示出确实的目录，而非使用链接（link）路径 如：
cd /var/mail
pwd # 会显示 /var/mail
pwd -P # 会显示 /var/spool/mail
ls -ld /var/mail # 就会发现输入 pwd 显示的 `/var/mail` 是一个链接文件，链接到 `/var/spool/mail`
####################################################
mkdir # 创建一个新的目录
mkdir -m # 设置文件的权限
mkdir -p # 帮助你直接将所需要的目录（包含上层目录）递回创建起来，比如我要递进创建如下目录：mkdir test1/test2/test3 在没有 -p 的参数下是无法新建成功的
####################################################
rmdir # 删除一个空的目录
rmdir -p # 递归删除目录，空目录也删掉
# 例如我要删除 test 开头的文件目录,先找出来
ls -ld test* # 前缀模糊搜索 test 开头的文件目录
rmdir test # 删除test，如果 test 目录里面是空的，则删除成功，如果含有子目录则要执行以下命令
rmdir -p test1/test2/test3/
####################################################
```

### 目录环境变量

```shell
echo $PATH # 输出所有的环境变量
PATH="${PATH}:/root" # 修改环境变量，将 /root 加入到环境变量中，这样就可以在执行 root 目录下的可执行的命令
# 需要注意的是，由于有高速缓存的存在，可能修改完环境变量后还没无法识别命令，只需要刷新下 执行如下命令
exit # 退出
su - # 登录
```

### 文件与目录的显示

```shell
ls [-aAdfFhilnrRst] 文件名或目录名称
ls [--color={never,auto,always}] 文件名或目录名称
ls [--full-time] 文件名或目录名称
# 其中选项与参数的意思：
-a: 全部的文件，连同隐藏文件（ 开头为 . 的文件） 一起列出来（常用）
-A: 全部的文件，连同隐藏文件，但不包括 . 与 .. 这两个目录
-d: 仅列出目录本身，而不是列出目录内的文件数据
-f: 直接列出结果，而不进行排序(ls 会默认文件名排序)
-F: 根据文件、目录等信息，给予附加数据结构，
    *:代表可可执行文件； /:代表目录； =:代表 socket 文件；等
-h: 将文件大小以人类较易读的方式（例如 GB, KB 等等）列出来
-i: 列出 inode 号码
-l: 长数据串行出，包含文件的属性与权限等等数据；（常用）
-n: 列出 UID 与 GID 而非使用者与群组的名称
-r: 将排序结果反向输出
-R: 连同子目录内容一起列出来，等于该目录下的所有文件都会显示出来
-S: 以文件大小大小排序，而不是用文件名排序；
-t: 依时间排序，而不是用文件名。
--color=never: 不要依据文件特性给予颜色显示
--color=always: 显示颜色
--color=auto: 系统自行判断
--full-time: 以完整时间模式 （包含年、月、日、时、分） 输出
--time={atime,ctime}: 输出 access 时间或改变权限属性时间 （ctime）
					而非内容变更时间 （modification time）
```



# 参考资料：

- [《鸟哥的Linux私房菜-基础篇》](http://linux.vbird.org/linux_basic/)